library(tidyverse)
install.packages("readxl")
library(readxl)
install.packages("car")
library(car)
install.packages("dplyr")
library(dplyr)

#Data Load In & Checking
data <- read_excel("Desktop/CVI_Cancer_nonan.xlsx")
cat("First few rows of the data:\n")
print(head(data))

#Basic Range, IQR, Median, Mean
cat("\nSummary Statistics:\n")
print(summary(data))

#Addditional Bivariate (Others on Python)
can_CVICC <- lm(Cancer ~ CVI_CC_score, data = CVI_Cancer_nonan)
summary(can_CVICC)

#Identifying Multicollinearity w Aliases and VIF
multcol1 <- lm(Cancer ~ ., data = CVI_Cancer_nonan)
aliases1 <- alias(multcol1)
print(aliases1)

vif1 <- car::vif(multcol1)
print(vif1)

#Removing Multicollinearity
#data <- data %>%
#  select(X)
#model <- lm(Cancer ~ ., data = CVI_Cancer_nonan)

#Multivariate Regression

#Stepwise Multivariate Regression
#cancer_model <- lm(Cancer ~ ., data = CVI_Cancer_nonan)
#stepwise_cancer_model <- step(cancer_model)
#summary(stepwise_cancer_model)

#Find aliases
allcan_findaliases <- lm(all_case ~ ., data = CVI_Cancer_nonan)
summary(allcan_findaliases)

aliases1 <- alias(allcan_findaliases)
print(aliases1)
vif1 <- car::vif(allcan_findaliases)
print(vif1)

# a = 0.1 significant for CC Health, CC EE, FreeSchLunch (No Aliases)
allcan_cvicc_demographics <- lm(all_case ~ ClimateChange_Health +ClimateChange_SocialEconomic
                                + ClimateChange_ExtremeEvents + Baseline_Environment
                                + Baseline_Infrastructure + Baseline_SocialEconomic
                                + HighBP + Stroke + COPD + CHD + CurrentDiabetes
                                +CurrentAdultAsthma + NoHSDiploma + Free_Red_SchLunch, data = CVI_Cancer_nonan)
summary(allcan_cvicc_demographics)

#All Cancer Cases, CVI CC, Demographics - Mul R^2:  0.7163,	Adj R^2:  0.5982 (No Significance; No Alias)
allcan_cvicc_demographics1 <- lm(all_case ~ CVI_CC_score + CVI_baseline_score
                                +HighBP + Stroke + COPD + CHD + CurrentDiabetes
                                +CurrentAdultAsthma + NoHSDiploma + Free_Red_SchLunch, data = CVI_Cancer_nonan)
summary(allcan_cvicc_demographics1)

#All Cancer Cases, CVI, Controlling for Known Factors = Medicare Ben 2022 Sig; 2nd is NONE (No Alias)
allcan_cvi_factorsknown1 <- lm(all_case ~ CVI_overall_score + COPD + Medicare_Benes_2022 
                              + Medicare_DME_per100 + DrgOverdoseDrate + SR_Phys_Health
                              + SR_Ment_Health + CurrentDiabetes + CurrentAdultAsthma
                              + Stroke + CHD + HighBP + NoHSDiploma + RiverFlood_AnnFreq
                              + SeaLevelRise + Tornado_AnnFreq
                              + Free_Red_SchLunch + Floodrisk_road + FEMAGrants + Floodrisk_prop 
                              + Drought_AnnFreq + Wildfire_AnnFreq + TotPrecip + CoastFlood_AnnFreq
                              + SeaLevelRise + Hurricane_AnnFreq + WinterWeather_AnnFreq, data = CVI_Cancer_nonan)
summary(allcan_cvi_factorsknown1)

#No Aliases
can_cvi_factorsknown <- lm(Cancer ~ CVI_overall_score + COPD + Medicare_Benes_2022 
                              + Medicare_DME_per100 + DrgOverdoseDrate + SR_Phys_Health
                              + SR_Ment_Health + CurrentDiabetes + CurrentAdultAsthma
                              + Stroke + CHD + HighBP + NoHSDiploma +  RiverFlood_AnnFreq
                              + SeaLevelRise + Tornado_AnnFreq
                              + Free_Red_SchLunch + Floodrisk_road + FEMAGrants + Floodrisk_prop 
                              + Drought_AnnFreq + Wildfire_AnnFreq + TotPrecip + CoastFlood_AnnFreq
                              + SeaLevelRise + Hurricane_AnnFreq + WinterWeather_AnnFreq, data = CVI_Cancer_nonan)
summary(can_cvi_factorsknown)

##All Cancer Cases, CVI, Riverine Flooding: Mul R^2 = 0.539;	Adj R^2 = 0.5102 
names(CVI_Cancer_nonan)[names(CVI_Cancer_nonan) == 'Riverine Flooding - Annualized Frequency'] <- 'RiverFlood_AnnFreq'
allcan_cvi_RiverFlood_AnnFreq <- lm(all_case ~ CVI_overall_score + RiverFlood_AnnFreq, data = CVI_Cancer_nonan)
summary(allcan_cvi_RiverFlood_AnnFreq)

###All Cancer Cases, CVI, DME: Mul R^2 = 0.9358; Adj R^2 = 0.9318
allcan_cvi_DME <- lm(all_case ~ CVI_overall_score + Medicare_Benes_DME, data = CVI_Cancer_nonan)
summary(allcan_cvi_DME)

###General Cancer, CVI, COPD: Mul R^2 = 0.707; Adj R^2 = 0.6886
can_cvi_COPD <- lm(Cancer ~ CVI_overall_score + COPD, data = CVI_Cancer_nonan)
summary(can_cvi_COPD)

#Breast Cancer Death, CVI, COPD: Mul R^2 = 0.296; Adj R^2 = 0.2518
breast_drate_cvi_COPD <- lm(breast_drate ~ CVI_overall_score + COPD, data = CVI_Cancer_nonan)
summary(breast_drate_cvi_COPD)

#Skin Incidence Rate, CVI, COPD: Mul R^2 = 0.4227; Asj R^2: 0.3866
skin_inc_rate_cvi_COPD <- lm(skin_inc_rate ~ CVI_overall_score + COPD, data = CVI_Cancer_nonan)
summary(skin_inc_rate_cvi_COPD)

#CVI Overall significant
all_drate_cvi_COPD <- lm(all_drate ~ CVI_overall_score + COPD, data = CVI_Cancer_nonan)
summary(all_drate_cvi_COPD)

allcan_cvi_DME100 <- lm(all_case ~ CVI_overall_score + Medicare_DME_per100, data = CVI_Cancer_nonan)
summary(allcan_cvi_DME100)

names(CVI_Cancer_nonan)[names(CVI_Cancer_nonan) == 'Drug Overdose Deaths per 100,000 People'] <- 'DrgOverdoseDrate'
allcan_cvi_drug <- lm(all_case ~ CVI_overall_score + DrgOverdoseDrate, data = CVI_Cancer_nonan)
summary(allcan_cvi_drug)

lung_drate_cvi_COPD <- lm(lung_drate ~ CVI_overall_score + COPD, data = CVI_Cancer_nonan)
summary(lung_drate_cvi_COPD)

colon_drate_cvi_COPD <- lm(colon_drate ~ CVI_overall_score + COPD, data = CVI_Cancer_nonan)
summary(colon_drate_cvi_COPD)

cervix_inc_rate_cvi_COPD <- lm(cervix_inc_rate ~ CVI_overall_score + COPD, data = CVI_Cancer_nonan)
summary(cervix_inc_rate_cvi_COPD)

names(CVI_Cancer_nonan)[names(CVI_Cancer_nonan) == 'Free or Reduced Price School Lunch'] <- 'Free_Red_SchLunch'
allcan_cvi_Free_Red_SchLunch <- lm(all_case ~ CVI_overall_score + Free_Red_SchLunch, data = CVI_Cancer_nonan)
summary(allcan_cvi_Free_Red_SchLunch)

names(CVI_Cancer_nonan)[names(CVI_Cancer_nonan) == 'Flooding risk to roads'] <- 'Floodrisk_road'
allcan_cvi_Floodrisk_road <- lm(all_case ~ CVI_overall_score + Floodrisk_road, data = CVI_Cancer_nonan)
summary(allcan_cvi_Floodrisk_road)

names(CVI_Cancer_nonan)[names(CVI_Cancer_nonan) == 'FEMA Hazard Mitigation Grants'] <- 'FEMAGrants'
allcan_cvi_FEMAGrants <- lm(all_case ~ CVI_overall_score + FEMAGrants, data = CVI_Cancer_nonan)
summary(allcan_cvi_FEMAGrants)

names(CVI_Cancer_nonan)[names(CVI_Cancer_nonan) == 'Flooding risk to properties'] <- 'Floodrisk_prop'
allcan_cvi_Floodrisk_prop <- lm(all_case ~ CVI_overall_score + Floodrisk_prop, data = CVI_Cancer_nonan)
summary(allcan_cvi_Floodrisk_prop)

names(CVI_Cancer_nonan)[names(CVI_Cancer_nonan) == 'Drought - Annualized Frequency'] <- 'Drought_AnnFreq'
allcan_cvi_Drought_AnnFreq <- lm(all_case ~ CVI_overall_score + Drought_AnnFreq, data = CVI_Cancer_nonan)
summary(allcan_cvi_Drought_AnnFreq)

names(CVI_Cancer_nonan)[names(CVI_Cancer_nonan) == 'Wildfire - Annualized Frequency'] <- 'Wildfire_AnnFreq'
allcan_cvi_Wildfire_AnnFreq <- lm(all_case ~ CVI_overall_score + Wildfire_AnnFreq, data = CVI_Cancer_nonan)
summary(allcan_cvi_Wildfire_AnnFreq)

names(CVI_Cancer_nonan)[names(CVI_Cancer_nonan) == 'Total Precipitation'] <- 'TotPrecip'
allcan_cvi_TotPrecip <- lm(all_case ~ CVI_overall_score + TotPrecip, data = CVI_Cancer_nonan)
summary(allcan_cvi_TotPrecip)

names(CVI_Cancer_nonan)[names(CVI_Cancer_nonan) == 'Coastal Flooding - Annualized Frequency'] <- 'CoastFlood_AnnFreq'
allcan_cvi_CoastFlood_AnnFreq <- lm(all_case ~ CVI_overall_score + CoastFlood_AnnFreq, data = CVI_Cancer_nonan)
summary(allcan_cvi_CoastFlood_AnnFreq)

names(CVI_Cancer_nonan)[names(CVI_Cancer_nonan) == 'Sea Level Rise'] <- 'SeaLevelRise'
allcan_cvi_SeaLevelRise <- lm(all_case ~ CVI_overall_score + SeaLevelRise, data = CVI_Cancer_nonan)
summary(allcan_cvi_SeaLevelRise)

names(CVI_Cancer_nonan)[names(CVI_Cancer_nonan) == 'Hurricane - Annualized Frequency'] <- 'Hurricane_AnnFreq'
allcan_cvi_Hurricane_AnnFreq <- lm(all_case ~ CVI_overall_score + Hurricane_AnnFreq, data = CVI_Cancer_nonan)
summary(allcan_cvi_Hurricane_AnnFreq)

names(CVI_Cancer_nonan)[names(CVI_Cancer_nonan) == 'Winter Weather - Annualized Frequency'] <- 'WinterWeather_AnnFreq'
allcan_cvi_WinterWeather_AnnFreq <- lm(all_case ~ CVI_overall_score + WinterWeather_AnnFreq, data = CVI_Cancer_nonan)
summary(allcan_cvi_WinterWeather_AnnFreq)

##This returns NA for SuicideRt -> maybe because all the same number?
names(CVI_Cancer_nonan)[names(CVI_Cancer_nonan) == 'Suicide Rates'] <- 'SuicideRt'
allcan_cvi_SuicideRt <- lm(all_case ~ CVI_overall_score + SuicideRt, data = CVI_Cancer_nonan)
summary(allcan_cvi_SuicideRt)

##This returns NA for DisasterCost -> maybe because all the same number?
names(CVI_Cancer_nonan)[names(CVI_Cancer_nonan) == 'Cost of climate disasters'] <- 'DisasterCost'
allcan_cvi_DisasterCost <- lm(all_case ~ CVI_overall_score + DisasterCost, data = CVI_Cancer_nonan)
summary(allcan_cvi_DisasterCost)

#COPD significant
can_EEWildfires_COPD <- lm(Cancer ~ CC_EE_Wildfires + COPD, data = CVI_Cancer_nonan)
summary(can_EEWildfires_COPD)

can_CVICC_COPD <- lm(Cancer ~ CVI_CC_score + COPD, data = CVI_Cancer_nonan)
summary(can_CVICC_COPD)

pros_inc_rate_cvi_COPD <- lm(pros_inc_rate ~ CVI_overall_score + COPD, data = CVI_Cancer_nonan)
summary(pros_inc_rate_cvi_COPD)

allcan_cvi_COPD <- lm(all_case ~ CVI_overall_score + COPD, data = CVI_Cancer_nonan)
summary(allcan_cvi_COPD)

#Only SR Phys Health Significant
names(CVI_Cancer_nonan)[names(CVI_Cancer_nonan) == 'Self-Reported Physical Health'] <- 'SR_Phys_Health'
allcan_cvi_SR_Phys_Health <- lm(all_case~ CVI_overall_score + SR_Phys_Health, data = CVI_Cancer_nonan)
summary(allcan_cvi_SR_Phys_Health)

#Only Tornado Significant
names(CVI_Cancer_nonan)[names(CVI_Cancer_nonan) == 'Tornado - Annualized Frequency'] <- 'Tornado_AnnFreq'
allcan_cvi_Tornado_AnnFreq <- lm(all_case ~ CVI_overall_score + Tornado_AnnFreq, data = CVI_Cancer_nonan)
summary(allcan_cvi_Tornado_AnnFreq)

#Extra (Insignificant)

all_inc_rate_cvi_COPD <- lm(all_inc_rate ~ CVI_overall_score + COPD, data = CVI_Cancer_nonan)
summary(all_inc_rate_cvi_COPD)

colon_inc_rate_CVICC <- lm(colon_inc_rate ~ CVI_CC_score, data = CVI_Cancer_nonan)
summary(colon_inc_rate_CVICC)

pros_drate_cvi_COPD <- lm(pros_drate ~ CVI_overall_score + COPD, data = CVI_Cancer_nonan)
summary(pros_drate_cvi_COPD)

can_CCEE_CCSE <- lm(Cancer ~ ClimateChange_ExtremeEvents + ClimateChange_SocialEconomic, data = CVI_Cancer_nonan)
summary(can_CCEE_CCSE)

names(CVI_Cancer_nonan)[names(CVI_Cancer_nonan) == 'Drug Overdose Deaths per 100,000 People'] <- 'DrgOverdoseDrate'
can_cvi_drug <- lm(Cancer ~ CVI_overall_score + DrgOverdoseDrate, data = CVI_Cancer_nonan)
summary(can_cvi_drug)

CCEE_cvi_CCSE <- lm(ClimateChange_ExtremeEvents ~ CVI_overall_score + ClimateChange_SocialEconomic, data = CVI_Cancer_nonan)
summary(CCEE_cvi_CCSE)

colon_inc_rate_cvi_COPD <- lm(colon_inc_rate ~ CVI_overall_score + COPD, data = CVI_Cancer_nonan)
summary(colon_inc_rate_cvi_COPD)

lung_inc_rate_cvi_COPD <- lm(lung_inc_rate ~ CVI_overall_score + COPD, data = CVI_Cancer_nonan)
summary(lung_inc_rate_cvi_COPD)

names(CVI_Cancer_nonan)[names(CVI_Cancer_nonan) == 'Self-Reported Mental Health'] <- 'SR_Ment_Health'
allcan_cvi_SR_Ment_Health <- lm(all_case~ CVI_overall_score + SR_Ment_Health, data = CVI_Cancer_nonan)
summary(allcan_cvi_SR_Ment_Health)

names(CVI_Cancer_nonan)[names(CVI_Cancer_nonan) == 'Current Diabetes'] <- 'CurrentDiabetes'
allcan_cvi_CurrentDiabetes <- lm(all_case ~ CVI_overall_score + CurrentDiabetes, data = CVI_Cancer_nonan)
summary(allcan_cvi_CurrentDiabetes)

names(CVI_Cancer_nonan)[names(CVI_Cancer_nonan) == 'Current Adult Asthma'] <- 'CurrentAdultAsthma'
allcan_cvi_CurrentAdultAsthma <- lm(all_case ~ CVI_overall_score + CurrentAdultAsthma, data = CVI_Cancer_nonan)
summary(allcan_cvi_CCurrentAdultAsthma)

allcan_cvi_Stroke <- lm(all_case ~ CVI_overall_score + Stroke, data = CVI_Cancer_nonan)
summary(allcan_cvi_Stroke)

allcan_cvi_CHD <- lm(all_case ~ CVI_overall_score + CHD, data = CVI_Cancer_nonan)
summary(allcan_cvi_CHD)

names(CVI_Cancer_nonan)[names(CVI_Cancer_nonan) == 'High Blood Pressure'] <- 'HighBP'
allcan_cvi_HighBP <- lm(all_case ~ CVI_overall_score + HighBP, data = CVI_Cancer_nonan)
summary(allcan_cvi_HighBP)

names(CVI_Cancer_nonan)[names(CVI_Cancer_nonan) == 'No High School Diploma'] <- 'NoHSDiploma'
allcan_cvi_NoHSDiploma <- lm(all_case ~ CVI_overall_score + NoHSDiploma, data = CVI_Cancer_nonan)
summary(allcan_cvi_NoHSDiploma)
